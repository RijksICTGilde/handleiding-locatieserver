[
["index.html", "PDOK LocatieServer Inleiding", " PDOK LocatieServer Willy Tadema Inleiding Dit is een handleiding voor PDOK LocatieServer. De inhoud van deze handleiding is eerder gepubliceerd als onderdeel van de web API workshops van Willy Tadema, Niene Boeijen en The Green Land bij de provincie Zuid-Holland1 en Gelderland2. In deze handleiding staan veel webservice requests. Deze requests kun je zelf uitproberen. Dat kun je in een internet browser doen, bijvoorbeeld in Google Chrome. Maar het kan ook handig zijn om een tool als Postman te gebruiken. Hoe je Postman installeert en de collectie met alle voorbeelden importeert, lees je in paragraaf 3.1. https://github.com/FrieseWoudloper/web-api-workshop↩ https://github.com/FrieseWoudloper/web-api-workshop-gelderland↩ "],
["intro.html", "1 PDOK LocatieServer", " 1 PDOK LocatieServer PDOK staat voor Publieke Dienstverlening Op de Kaart3. PDOK is een platform voor het delen van geografische datasets van de Nederlandse overheid. Gegevens worden gedeeld via webservices of bestanden. PDOK LocatieServer is een zoekdienst. Met LocatieServer kun je bijvoorbeeld zoeken op adressen, wegen, kadastrale percelen, buurten en hectometerpaaltjes in betrouwbare en actuele databronnen van de overheid. Met LocatieServer kun je geocoderen. Dat wil zeggen: een beschrijving van een locatie omzetten naar geometrie. Zo kun je bijvoorbeeld een adres koppelen aan x- en y-coördinaten. Reuzehandig! Naast coördinaten geeft LocatieServer ook identificatienummers terug. Deze nummers kun je gebruiken om aanvullende informatie op te vragen bij andere registraties. Voorbeelden zijn het perceelnummer, de buurtcode en de waterschapscode. LocatieServer heeft een application programming interface (API). Dat maakt het eenvoudig om LocatieServer te gebruiken in je eigen web applicaties. De URL voor requests naar LocatieServer is: https://geodata.nationaalgeoregister.nl/locatieserver/&lt;versie&gt;/&lt;service&gt; Versie 3 is het meest actueel. Die kun je het beste gebruiken. LocatieServer biedt drie services: free: een ‘klassieke’ geocodeerservice, suggest: voor het interactief zoeken naar locaties, bijvoorbeeld voor auto complete functionaliteit in het zoekscherm van een webapplicatie, lookup: voor het opvragen van detailinformatie over één object op basis van een identificatienummer. Lees voor meer informatie de documentatie van PDOK of ga meteen door naar het volgende onderdeel van de handleiding. https://www.pdok.nl↩ "],
["free.html", "2 free service 2.1 Zoeken op vrije tekst 2.2 Zoeken op adres 2.3 Zoekresultaten filteren 2.4 Zoeken zonder exacte match 2.5 Geometrie opvragen 2.6 Zoeken naar objecten in de buurt 2.7 Toepassingen", " 2 free service Met de free service kun je locatiegegevens, bijvoorbeeld een adres, verrijken met coördinaten. De service biedt ook de mogelijkheid om gegevens te standaardiseren. Zo kun je van adressen de officiële schrijfwijze ophalen uit de Basisregistratie Adressen en Gebouwen (BAG). De free service levert daarnaast identificatienummers waarmee je eenduidige koppelingen kunt leggen met gegevens in andere registraties. De URL van de free service is https://geodata.nationaalgeoregister.nl/locatieserver/3/free 2.1 Zoeken op vrije tekst Laten we beginnen met een simpele bevraging (ofwel request) waarin we zoeken op het adres van het provinciehuis in Groningen. Hiervoor breiden we de URL uit met de query parameter q. Parameter Waarde Beschrijving q Sint Jansstraat 4 Groningen zoekterm Het request wordt dan https://geodata.nationaalgeoregister.nl/locatieserver/3/free?q=Sint Jansstraat 4 Groningen Klik op bovenstaande hyperlink en bekijk het antwoord dat je terugkrijgt (de response). De response bevat tien zoekresultaten, ofwel rijen. Elke rij bestaat uit een aantal velden. Het aantal en het soort velden kan per rij verschillen. Om het iets overzichtelijker te maken, maken we een nieuw request. Deze keer beperken we het aantal rijen en velden met de parameters rows en fl. Parameter Waarde Beschrijving q Sint Jansstraat 4 Groningen zoekterm rows 5 maximum aantal rijen in de response fl weergavenaam,type,score lijst met velden in de response Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Sint Jansstraat 4 Groningen&rows=5&fl=weergavenaam,type,score Response: { &quot;response&quot;: { &quot;numFound&quot;: 538023, &quot;start&quot;: 0, &quot;maxScore&quot;: 36.76614, &quot;docs&quot;: [{ &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat, Groningen&quot;, &quot;score&quot;: 36.76614 }, { &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Nieuwe Sint Jansstraat, Groningen&quot;, &quot;score&quot;: 35.70356 }, { &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 4, 9712JN Groningen&quot;, &quot;score&quot;: 35.58896 }, { &quot;type&quot;: &quot;postcode&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat, 9712JM Groningen&quot;, &quot;score&quot;: 32.440468 }, { &quot;type&quot;: &quot;postcode&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat, 9712JN Groningen&quot;, &quot;score&quot;: 32.440468 } ] } } De service retourneert vijf zoekresultaten. Ieder resultaat heeft een score. Het resultaat met de hoogste score staat bovenaan. Het is een weg, en niet het adres waar we naar op zoek waren. Dat verschijnt pas als derde in de lijst. Hoe kan dat? 2.2 Zoeken op adres LocatieServer zoekt in meerdere databronnen en op verschillende objecttypes. Als we niet specifiek aangeven in welke bron we willen zoeken of op welk objecttype, kunnen we allerlei soorten objecten terugkrijgen. Niet alleen adressen, maar bijvoorbeeld ook wegen of postcodes. Als we alleen op adressen willen zoeken, geven we dat aan in de filter query (fq). Parameter Waarde Beschrijving q Sint Jansstraat 4 Groningen zoekterm rows 5 maximum aantal rijen in de response fl weergavenaam,type,score lijst met velden in de response fq type:adres filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Sint Jansstraat 4 Groningen&rows=5&fl=weergavenaam,type,score&fq=type:adres Wanneer we bovenstaand request doen, krijgen we alleen adressen terug: { &quot;response&quot;: { &quot;numFound&quot;: 514875, &quot;start&quot;: 0, &quot;maxScore&quot;: 35.58896, &quot;docs&quot;: [{ &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 4, 9712JN Groningen&quot;, &quot;score&quot;: 35.58896 }, { &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 2a, 9712JN Groningen&quot;, &quot;score&quot;: 30.845457 }, { &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 2b, 9712JN Groningen&quot;, &quot;score&quot;: 30.845457 }, { &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 2c, 9712JN Groningen&quot;, &quot;score&quot;: 30.845457 }, { &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 2d, 9712JN Groningen&quot;, &quot;score&quot;: 30.845457 } ] } } We kunnen ook zoeken op basis van postcode en huisnummer. Parameter Waarde Beschrijving q 9712JN 4 zoekterm rows 1 maximum aantal rijen in de response fl weergavenaam,type,score lijst met velden in de response fq type:adres filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=9712JN 4&rows=1&fl=weergavenaam,type,score&fq=type:adres Ook nu vinden we het juiste adres: { &quot;response&quot;: { &quot;numFound&quot;: 226733, &quot;start&quot;: 0, &quot;maxScore&quot;: 23.890985, &quot;docs&quot;: [{ &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 4, 9712JN Groningen&quot;, &quot;score&quot;: 23.890985 } ] } } 2.3 Zoekresultaten filteren In de vorige paragraaf hebben we gezien dat we een filter kunnen meegeven in het web request. Het standaard filter is fq=type:(gemeente OR woonplaats OR weg OR postcode OR adres). Als we géén filter opgeven, zoekt LocatieServer dus naar gemeenten, woonplaatsen, wegen, postcodes én adressen! We kunnen niet alleen op adres, maar ook op andere objecttypen filteren. In onderstaande tabel staan alle geldige waarden. De tabel geeft een overzicht van objecttypen per gegevensbron. Het is ook mogelijk om op gegevensbron te filteren. Met fq=bron:CBS zoeken we bijvoorbeeld alleen naar CBS buurten en wijken. We kunnen ook filteren op een combinatie van objecttype en gegevensbron. Het filter fq=type:adres AND bron:BAG geeft echter hetzelfde resultaat als fq=type:adres. Adressen komen namelijk per definitie uit de BAG. De velden in de response verschillen per objecttype. Voor een adres geeft de service bijvoorbeeld andere velden terug dan voor een buurt. Dit is niet gedocumenteerd. Het beste is om het gewoon uit te proberen. bron Omschrijving type BAG Basisregistratie Adressen en Gebouwen (BAG) adrespostcodewegwoonplaats NWB Nationaal Wegen Bestand (NWB) weghectometerpaal BAG/NWB Combinatie van BAG en NWB weg Bestuurlijke Grenzen Basisregistratie Kadaster (BRK) gemeente provincie DKK Digitale Kadastrale Kaart, product van de BRK appartementsrechtperceel CBS Centraal Bureau voor de Statistiek buurt wijk HWH Het Waterschapshuis waterschapsgrens Is er eigenlijk ook in Sint Jansstraat in Zuid-Holland? Laten we dat eens uitzoeken. Om aan te geven dat we alleen geïnteresseerd zijn in wegen in Zuid-Holland, passen we het filter aan. Parameter Waarde Beschrijving q Sint Jansstraat zoekterm rows 3 maximum aantal rijen in de response fl weergavenaam,type,provincienaam lijst met velden in de response fq type:weg AND provincienaam=Zuid-Holland filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Sint Jansstraat&rows=3&fl=weergavenaam,type,provincienaam&fq=type:weg AND provincienaam:Zuid-Holland Response: { &quot;response&quot;: { &quot;numFound&quot;: 420, &quot;start&quot;: 0, &quot;maxScore&quot;: 29.761024, &quot;docs&quot;: [{ &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat, Amsterdam&quot;, &quot;provincienaam&quot;: &quot;Noord-Holland&quot; }, { &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Jansstraat, Haarlem&quot;, &quot;provincienaam&quot;: &quot;Noord-Holland&quot; }, { &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Jansstraat, Edam&quot;, &quot;provincienaam&quot;: &quot;Noord-Holland&quot; } ] } } Dit gaat niet goed! We krijgen weliswaar zoekresultaten terug, maar die liggen in Noord-Holland. Wat is er aan de hand? LocatieServer negeert het koppelteken in Zuid-Holland en beperkt de zoekopdracht tot provincies met Zuid of Holland in de naam! Dit kunnen we voorkomen door de provincienaam tussen aanhalingstekens te plaatsen. Parameter Waarde Beschrijving q Sint Jansstraat zoekterm rows 3 maximum aantal rijen in de response fl weergavenaam,type,provincienaam lijst met velden in de response fq type:weg AND provincienaam=“Zuid-Holland” filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Sint Jansstraat&rows=3&fl=weergavenaam,type,provincienaam&fq=type:weg AND provincienaam:\"Zuid-Holland\" Response: { &quot;response&quot;: { &quot;numFound&quot;: 130, &quot;start&quot;: 0, &quot;maxScore&quot;: 14.076424, &quot;docs&quot;: [{ &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Sint Aagtenstraat, Leiden&quot;, &quot;provincienaam&quot;: &quot;Zuid-Holland&quot; }, { &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Sint Agathaplein, Delft&quot;, &quot;provincienaam&quot;: &quot;Zuid-Holland&quot; }, { &quot;type&quot;: &quot;weg&quot;, &quot;weergavenaam&quot;: &quot;Sint Aldegondestraat, Delft&quot;, &quot;provincienaam&quot;: &quot;Zuid-Holland&quot; } ] } } Uit de response op de twee requests blijkt, dat er wel een Sint Jansstraat in Noord-Holland is, maar geen in Zuid-Holland. 2.4 Zoeken zonder exacte match LocatieServer vindt ook resultaten zonder exacte match, zoals in onderstaand voorbeeld. Parameter Waarde Beschrijving q St Jansstr 4 Groningen zoekterm rows 1 maximum aantal rijen in de response fl weergavenaam,type,score lijst met velden in de response fq type:adres filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=St Jansstr 4 Groningen&rows=1&fl=weergavenaam,type,score&fq=type:adres Ondanks dat de straatnaam is afgekort, vinden we nog steeds het juiste adres. { &quot;response&quot;: { &quot;numFound&quot;: 515205, &quot;start&quot;: 0, &quot;maxScore&quot;: 29.294895, &quot;docs&quot;: [{ &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 4, 9712JN Groningen&quot;, &quot;score&quot;: 29.294895 } ] } } LocatieServer negeert leestekens, diakrieten en hoofdletters. Straatnamen kunnen worden ingekort en postcodes mogen wel of geen spatie hebben, het maakt LocatieServer niet uit. LocatieServer heeft nog meer handigheidjes. Voor een aantal woonplaatsen kent LocatieServer bijvoorbeeld synoniemen. Parameter Waarde Beschrijving q Sint Jansstraat 4 Den Bosch zoekterm rows 1 maximum aantal rijen in de response fl weergavenaam,type,score lijst met velden in de response fq type:adres filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Sint Jansstraat 4 Den Bosch&rows=1&fl=weergavenaam,type,score&fq=type:adres Response: { &quot;response&quot;: { &quot;numFound&quot;: 1629004, &quot;start&quot;: 0, &quot;maxScore&quot;: 39.094322, &quot;docs&quot;: [{ &quot;type&quot;: &quot;adres&quot;, &quot;weergavenaam&quot;: &quot;Sint Jansstraat 4, 5211DL &#39;s-Hertogenbosch&quot;, &quot;score&quot;: 39.094322 } ] } } LocatieServer weet dus dat met Den Bosch en ’s-Hertogenbosch dezelfde woonplaats wordt bedoeld. 2.5 Geometrie opvragen Wat zijn de coördinaten van het adres dat LocatieServer heeft gevonden? We kunnen de centroïde van een geretourneerd object opvragen. centroide_ll bevat een punt in het WGS 84 coördinatenstelsel en centroide_rd in RD New. De geometrie is in Well-Known Text (WKT) formaat. Parameter Waarde Beschrijving q Sint Jansstraat 4 Groningen zoekterm rows 1 maximum aantal rijen in de response fl weergavenaam,centroide_ll,centroide_rd lijst met velden in de response fq type:adres filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Sint Jansstraat 4 Groningen&rows=1&fl=weergavenaam,centroide_ll,centroide_rd&fq=type:adres We kunnen verifiëren of de response de juiste coördinaten teruggeeft door de waarde van centroide_ll naar de OpenStreetMap WKT Playground te kopiëren. Voor adressen is de centroïde gelijk aan de locatie van het adres. Voor andere objecttypen zoals wegen of woonplaatsen is een lijn of vlak misschien beter dan een centroïde. Die wordt opgeslagen in de velden geometrie_ll en geometrie_rd. Ter illustratie vragen we de woonplaatsgrens van Groningen op. Parameter Waarde Beschrijving q Groningen zoekterm rows 1 maximum aantal rijen in de response fl weergavenaam,geometrie_ll,geometrie_rd lijst met velden in de response fq type:woonplaats filter op de zoekresultaten Request: https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=Groningen&rows=1&fl=weergavenaam,geometrie_ll,geometrie_rd&fq=type:woonplaats De woonplaatsgrens kunnen we bekijken in de OpenStreetMap WKT Playground. Let op: als je een wildcard (*) opgeeft in de fl parameter worden geometrie_ll en geometrie_rd niet opgenomen in de response! Het is overigens ook mogelijk om geometrie in GeoJSON formaat op te vragen. Dit staat beschreven in paragraaf 3.4. 2.6 Zoeken naar objecten in de buurt 2.7 Toepassingen "],
["tips-tricks.html", "3 Tips &amp; Tricks 3.1 Postman 3.2 Apache Solr 3.3 Debuggen 3.4 Response formaat 3.5 Documentatie 3.6 Geoforum", " 3 Tips &amp; Tricks In dit hoofdstuk vind je nog wat handige tips voor het werken met LocatieServer. 3.1 Postman 3.2 Apache Solr LocatieServer gebruikt Apache Solr als search engine. Raadpleeg de Reference Guide voor meer informatie over zoeken met met Solr. 3.3 Debuggen Als je tegen problemen aanloopt, kun je de debug parameter aan je request toevoegen voor meer informatie. Met debug=timing krijg je bijvoorbeeld informatie over hoe lang het duurde om de query in Solr uit te voeren. https://geodata.nationaalgeoregister.nl/locatieserver/3/free?q=9712JN 4&rows=1&debug=timing De meest uitgebreide debug informatie krijg je met debug=all in je request. https://geodata.nationaalgeoregister.nl/locatieserver/3/free?q=9712JN 4&rows=1&debug=all Raadpleeg de Solr documentatie voor meer informatie over de debug parameter. 3.4 Response formaat Standaard stuurt LocatieServer de response in json formaat terug. Met behulp van de wt parameter kun je ook andere formaten specificeren, bijvoorbeeld xml. https://geodata.nationaalgeoregister.nl/locatieserver/3/free?q=9712JN 4&wt=xml Een andere optie is csv. Je kunt ook parameters toevoegen om het scheidingsteken aan te passen (csv.separator) of aan te geven of de response veldnamen moet bevatten (csv.header). https://geodata.nationaalgeoregister.nl/locatieserver/v3/free?q=9712JN 4&wt=csv&csv.separator=;&csv.header=false Zelfs geojson is mogelijk, maar dan moet je ook de parameter geojson.field opnemen in het request. De parameter bevat de naam van het veld met de geometrie. https://geodata.nationaalgeoregister.nl/locatieserver/3/free?q=9712JN 4&wt=geojson&geojson.field=centroide_ll Raadpleeg de Solr documentatie over Response Writers voor meer informatie. 3.5 Documentatie LocatieServer API documentatie LocatieServer wiki 3.6 Geoforum Het Geoforum is de beste plek om je vragen over LocatieServer te stellen. "]
]
